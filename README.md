# goit-secure-hw-7

# AXIOS

bash -lc 'set -euo pipefail; command -v jq >/dev/null || { echo "jq not found. Install: sudo apt install -y jq"; exit 1; }; ROOT="$HOME/Documents/GitHub/goit-secure-hw-7"; DIR="$ROOT/pkgA-axios"; PKGVER="0.21.1"; cd "$DIR"; rm -rf node_modules package-lock.json; rm -f sbom.* grype.txt tree.txt license.txt ghsa.txt ghsa_to_cve.tsv cves.txt cve_epss.tsv package.json; npm init -y >/dev/null; npm install "axios@$PKGVER" --save-exact >/dev/null; npm ls --all > tree.txt; npm view "axios@$PKGVER" license > license.txt; if syft dir:. -o cyclonedx-json@1.5 > sbom.cdx.json 2>/dev/null; then SBOM="sbom.cdx.json"; else syft dir:. -o syft-json > sbom.syft.json; SBOM="sbom.syft.json"; fi; grype "sbom:$SBOM" > grype.txt; grep -Eo "GHSA-[a-z0-9-]+" -h grype.txt | sort -u > ghsa.txt || true; : > ghsa_to_cve.tsv; if [ -s ghsa.txt ]; then while read -r ghsa; do cves="$(curl -s "https://api.osv.dev/v1/vulns/$ghsa" | jq -r ".aliases[]? | select(startswith(\"CVE-\"))" | paste -sd, -)"; echo -e "${ghsa}\t${cves:-N/A}" >> ghsa_to_cve.tsv; done < ghsa.txt; fi; cut -f2 ghsa_to_cve.tsv 2>/dev/null | tr "," "\n" | grep -E "^CVE-" | sort -u > cves.txt || true; cves_csv="$(paste -sd, cves.txt 2>/dev/null || true)"; if [ -n "${cves_csv:-}" ]; then curl -s "https://api.first.org/data/v1/epss?cve=$cves_csv" | jq -r ".data[] | [.cve,.epss,.percentile,.date] | @tsv" > cve_epss.tsv; else : > cve_epss.tsv; fi; echo "DONE AXIOS"; echo "CVE:"; cat cves.txt || true; echo "EPSS:"; column -t cve_epss.tsv || true'

# NODE-FETCH

bash -lc 'set -euo pipefail; command -v jq >/dev/null || { echo "jq not found. Install: sudo apt install -y jq"; exit 1; }; ROOT="$HOME/Documents/GitHub/goit-secure-hw-7"; DIR="$ROOT/pkgB-node-fetch"; PKGVER="2.6.7"; cd "$DIR"; rm -rf node_modules package-lock.json; rm -f sbom.* grype.txt tree.txt license.txt ghsa.txt ghsa_to_cve.tsv cves.txt cve_epss.tsv package.json; npm init -y >/dev/null; npm install "node-fetch@$PKGVER" --save-exact >/dev/null; npm ls --all > tree.txt; npm view "node-fetch@$PKGVER" license > license.txt; if syft dir:. -o cyclonedx-json@1.5 > sbom.cdx.json 2>/dev/null; then SBOM="sbom.cdx.json"; else syft dir:. -o syft-json > sbom.syft.json; SBOM="sbom.syft.json"; fi; grype "sbom:$SBOM" > grype.txt; grep -Eo "GHSA-[a-z0-9-]+" -h grype.txt | sort -u > ghsa.txt || true; : > ghsa_to_cve.tsv; if [ -s ghsa.txt ]; then while read -r ghsa; do cves="$(curl -s "https://api.osv.dev/v1/vulns/$ghsa" | jq -r ".aliases[]? | select(startswith(\"CVE-\"))" | paste -sd, -)"; echo -e "${ghsa}\t${cves:-N/A}" >> ghsa_to_cve.tsv; done < ghsa.txt; fi; cut -f2 ghsa_to_cve.tsv 2>/dev/null | tr "," "\n" | grep -E "^CVE-" | sort -u > cves.txt || true; cves_csv="$(paste -sd, cves.txt 2>/dev/null || true)"; if [ -n "${cves_csv:-}" ]; then curl -s "https://api.first.org/data/v1/epss?cve=$cves_csv" | jq -r ".data[] | [.cve,.epss,.percentile,.date] | @tsv" > cve_epss.tsv; else : > cve_epss.tsv; fi; echo "DONE NODE-FETCH"; echo "CVE:"; cat cves.txt || true; echo "EPSS:"; column -t cve_epss.tsv || true'
